---
import { getCollection, type CollectionEntry } from "astro:content"
import MainLayout from "../layouts/MainLayout.astro"

type Experience = CollectionEntry<"experiences">
type Skill = CollectionEntry<"skills">

const experiences: Experience[] = (await getCollection("experiences")).sort(
  (a: Experience, b: Experience) => b.data.id - a.data.id,
)

const skills: Skill[] = (await getCollection("skills")).sort(
  (a: Skill, b: Skill) => a.data.id - b.data.id,
)
---

<MainLayout title="Curriculum Vitae">
  <div class="mt-[-2rem] flex flex-col sm:mt-[-4rem] md:flex-row">
    <!-- Skills Section -->
    <div class="w-full p-4 font-jbmono md:w-1/2">
      <ul>
        {
          skills.map((skill) => (
            <li class="mb-6">
              <div class="relative grid pb-1 sm:grid-cols-8 sm:gap-8 md:gap-4">
                <header class="text-md mb-2 mt-1 font-semibold text-black underline underline-offset-4 sm:col-span-8">
                  {skill.data.name}
                </header>
                <div class="flex flex-wrap gap-x-4 gap-y-2 font-medium text-black sm:col-span-8">
                  {skill.data.items.map((item) => (
                    <span class="text-sm leading-5 tracking-tight text-black">
                      {item}
                    </span>
                  ))}
                </div>
              </div>
            </li>
          ))
        }
      </ul>
    </div>

    <!-- Divider using border-l -->
    <div class="mx-4 hidden sm:block md:border-l md:border-black"></div>

    <!-- Experience Section -->
    <div class="w-full p-4 md:w-1/2">
      <ul>
        {
          experiences.map((exp) => (
            <li class="mb-12">
              <div class="relative grid pb-1 transition-all hover:bg-[#d1c6bf] hover:text-teal-500 sm:grid-cols-8 sm:gap-8 md:gap-4">
                <header class="mb-2 mt-1 text-xs font-semibold uppercase tracking-wide text-black sm:col-span-2">
                  {exp.data.date}
                </header>
                <div class="sm:col-span-6">
                  <h3 class="font-medium leading-snug">
                    <a
                      class="inline-flex items-baseline text-base font-medium leading-tight"
                      href="#"
                      target="_blank"
                      rel="noreferrer noopener"
                    >
                      <span>{`${exp.data.role} Â· ${exp.data.company}`}</span>
                    </a>
                  </h3>
                  <p class="mt-2 text-sm leading-normal text-gray-600">
                    {exp.data.description}
                  </p>
                  <ul class="mt-2 flex flex-wrap" aria-label="Points">
                    {exp.data.points.map((point) => (
                      <li class="mr-1.5 mt-2">
                        <div class="inline-block rounded-sm bg-gray-200 px-2 py-1 text-sm text-gray-700">
                          {point}
                        </div>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</MainLayout>
